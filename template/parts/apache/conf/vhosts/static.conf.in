#
# Virtual Hosts
#

<VirtualHost *:${config:apache-static-port}>
    ServerAdmin team42@studivz.net
    ServerName data.static.local
    ServerAlias data.static.localhost
    ServerAlias data.static.${hostname}
    ServerAlias data.static.${hostname}.${config:domain}
    ServerAlias data.static.lan.${hostname}
    ServerAlias data.static.lan.${hostname}.${config:domain}
    ServerAlias data.static.wlan.${hostname}
    ServerAlias data.static.wlan.${hostname}.${config:domain}

    DocumentRoot ${buildout:directory}/Sites/Static/data

    DirectoryIndex index.php index.html index.htm

    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>

    <Directory ${buildout:directory}/Sites/Static/data>
        Options FollowSymLinks All
        Order deny,allow
        Allow from all
    </Directory>

    # use default logfile locations, defined in httpd.conf
#    ErrorLog ${buildout:directory}/Sites/Logs/data-static-error_log
#    CustomLog ${buildout:directory}/Sites/Logs/data-static-access_log common
</VirtualHost>

<VirtualHost *:${config:apache-static-port}>
    ServerAdmin team42@studivz.net
    ServerName root.static.local
    ServerAlias root.static.localhost
    ServerAlias root.static.${hostname}
    ServerAlias root.static.${hostname}.${config:domain}
    ServerAlias root.static.lan.${hostname}
    ServerAlias root.static.lan.${hostname}.${config:domain}
    ServerAlias root.static.wlan.${hostname}
    ServerAlias root.static.wlan.${hostname}.${config:domain}

    DocumentRoot ${buildout:directory}/Sites/Static

    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>

    <Directory ${buildout:directory}/Sites/Static>
        Options FollowSymLinks All
        Order deny,allow
        Allow from all

        RewriteEngine on
        RewriteRule ^(.*/)?\d{8}-\d{1,6}/(.*)$ $1$2
    </Directory>

    # use default logfile locations, defined in httpd.conf
#    ErrorLog ${buildout:directory}/Sites/Logs/root-static-error_log
#    CustomLog ${buildout:directory}/Sites/Logs/root-static-access_log common
</VirtualHost>

<VirtualHost *:${config:apache-static-port}>
    ServerAdmin murcs@studivz.net
    ServerName oembed.static.local
    ServerAlias oembed.static.localhost
    ServerAlias oembed.static.${hostname}
    ServerAlias oembed.static.${hostname}.${config:domain}
    ServerAlias oembed.static.lan.${hostname}
    ServerAlias oembed.static.lan.${hostname}.${config:domain}
    ServerAlias oembed.static.wlan.${hostname}
    ServerAlias oembed.static.wlan.${hostname}.${config:domain}

    DocumentRoot ${buildout:directory}/Sites/Static/oembed/build

    RewriteEngine on    

    RewriteRule ^(.*/)?\d{8}-\d{1,6}/(.*)$ $1$2

    RewriteRule ^/oembed\.html(.*)$ /oembed_local.html$1 [L]

    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>

    <Directory ${buildout:directory}/Sites/Static/oembed/build>
        Options FollowSymLinks All
        Order deny,allow
        Allow from all
    </Directory>

    # use default logfile locations, defined in httpd.conf
    ErrorLog ${buildout:directory}/parts/apache/logs/oembed-static-error_log
    CustomLog ${buildout:directory}/parts/apache/logs/oembed-static-access_log common
</VirtualHost>

<VirtualHost *:${config:apache-static-port}>
    ServerAdmin murcs@studivz.net
    ServerName auth.static.local
    ServerAlias auth.static.localhost
    ServerAlias auth.static.${hostname}
    ServerAlias auth.static.${hostname}.${config:domain}
    ServerAlias auth.static.lan.${hostname}
    ServerAlias auth.static.lan.${hostname}.${config:domain}
    ServerAlias auth.static.wlan.${hostname}
    ServerAlias auth.static.wlan.${hostname}.${config:domain}

    DocumentRoot ${buildout:directory}/Sites/Static/auth

    RewriteEngine on    

    RewriteCond %{QUERY_STRING} !^(.*)&avz_host=[0-9a-zA-Z\-\.]*avz\.${hostname}:${config:nginx-port}&svz_host=[0-9a-zA-Z\-\.]*svz\.${hostname}:${config:nginx-port}&pvz_host=[0-9a-zA-Z\-\.]*pvz\.${hostname}:${config:nginx-port}$
    RewriteRule ^/director\.html$ /director_error.html [R,L]

    DirectoryIndex auth.html

    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>

    <Directory ${buildout:directory}/Sites/Static/auth>
        Options FollowSymLinks All
        Order deny,allow
        Allow from all
    </Directory>

    # use default logfile locations, defined in httpd.conf
    ErrorLog ${buildout:directory}/parts/apache/logs/auth-static-error_log
    CustomLog ${buildout:directory}/parts/apache/logs/auth-static-access_log common
</VirtualHost>